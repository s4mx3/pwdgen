<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Password Generator</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    :root {
      /* Dark theme colors */
      --bg: #0a0a0f;
      --surface: rgba(26, 26, 46, 0.8);
      --surface-hover: rgba(37, 37, 66, 0.9);
      --text: #e2e8f0;
      --text-muted: #94a3b8;
      --border: rgba(45, 45, 68, 0.5);
      --border-hover: rgba(61, 61, 84, 0.7);
      
      /* Accent colors */
      --primary: #3b82f6;
      --primary-hover: #2563eb;
      --primary-light: rgba(59, 130, 246, 0.1);
      
      /* Status colors */
      --danger: #ef4444;
      --warning: #f59e0b;
      --success: #10b981;
      --excellent: #3b82f6;
      
      /* UI elements */
      --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
      --shadow: 0 4px 8px rgba(0,0,0,0.15);
      --shadow-lg: 0 8px 16px rgba(0,0,0,0.2);
      --radius: 16px;
      --radius-lg: 24px;
      --radius-full: 9999px;
      --transition: 0.2s ease;
      
      /* Typography */
      --font-sans: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
      --font-mono: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    }

    html {
      box-sizing: border-box;
      height: 100%;
      overflow-x: hidden;
    }

    *, *:before, *:after {
      box-sizing: inherit;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      margin: 0;
      font-family: var(--font-sans);
      color: var(--text);
      transition: color var(--transition);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 1rem;
      line-height: 1.5;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, var(--bg), #1a1a2e);
      z-index: -2;
    }

    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.1), transparent 70%);
      pointer-events: none;
      z-index: -1;
    }

    main {
      width: 100%;
      max-width: 480px;
      background: var(--surface);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      padding: 2rem;
      transition: all var(--transition);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--border);
      position: relative;
      z-index: 1;
    }

    h1 {
      font-size: 1.75rem;
      margin: 0 0 1.5rem 0;
      text-align: center;
      font-weight: 700;
      color: var(--text);
      letter-spacing: -0.02em;
    }

    .password-group {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      background: rgba(10, 10, 15, 0.5);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.25rem;
      transition: all var(--transition);
      box-shadow: var(--shadow);
      position: relative;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .password-group:focus-within {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px var(--primary-light), inset 0 2px 4px rgba(0,0,0,0.1);
      transform: translateY(-1px);
    }

    .password-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2.75rem;
      height: 2.75rem;
      border: none;
      border-radius: var(--radius);
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
      cursor: pointer;
      transition: all var(--transition);
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .btn-icon::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(rgba(255,255,255,0.2), transparent);
      opacity: 0;
      transition: opacity var(--transition);
    }

    .btn-icon:hover::after {
      opacity: 1;
    }

    .btn-icon:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-lg);
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .btn-icon:active {
      transform: translateY(0);
      box-shadow: var(--shadow-sm);
    }

    .btn-icon i {
      font-size: 1.1rem;
    }

    .btn-icon.success {
      background: var(--success);
      color: white;
      animation: successPulse 0.3s ease;
    }

    .btn-icon.loading {
      background: rgba(255, 255, 255, 0.15);
      color: var(--text);
    }

    .btn-icon:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      pointer-events: none;
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.05);
    }

    @keyframes successPulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 0.5rem 0.75rem;
      border-radius: var(--radius);
      font-size: 0.875rem;
      pointer-events: none;
      opacity: 0;
      transform: translateY(4px);
      transition: all var(--transition);
      z-index: 1000;
      white-space: nowrap;
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }

    .tooltip::before {
      content: '';
      position: absolute;
      top: -4px;
      left: 50%;
      transform: translateX(-50%);
      border-left: 4px solid transparent;
      border-right: 4px solid transparent;
      border-bottom: 4px solid rgba(0, 0, 0, 0.8);
    }

    .tooltip.visible {
      opacity: 1;
      transform: translateY(0);
    }

    #password {
      flex: 1;
      font-size: 1.25rem;
      font-family: var(--font-mono);
      padding: 0.75rem 1rem;
      border: none;
      background: transparent;
      color: var(--text);
      transition: all var(--transition);
      outline: none;
      min-width: 0;
      user-select: all;
      padding-right: 6rem;
    }

    #password::placeholder,
    #password::-webkit-input-placeholder,
    #password:-ms-input-placeholder,
    #password::-moz-placeholder,
    #password:-moz-placeholder {
      color: #888;
      font-style: italic;
      font-size: 0.9em;
      font-family: sans-serif;
      opacity: 0.7;
    }

    #password-placeholder-fallback {
      position: absolute;
      left: 1.25rem;
      right: calc(2.75rem * 2 + 1.5rem);
      top: 50%;
      transform: translateY(-50%);
      color: #888;
      font-style: italic;
      font-size: 0.85rem;
      font-family: var(--font-mono);
      font-weight: 400;
      opacity: 0.7;
      pointer-events: none;
      user-select: none;
      z-index: 2;
      transition: opacity 0.2s;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: calc(100% - 7rem);
      display: none;
    }

    .toggle-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      padding: 1.25rem;
      background: rgba(10, 10, 15, 0.5);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid var(--border);
    }

    .toggle-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--radius);
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition);
      user-select: none;
      height: 2.75rem;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      width: 100%;
    }

    .toggle-btn i {
      font-size: 1.1rem;
      color: var(--text);
      transition: all var(--transition);
    }

    .toggle-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      color: var(--text);
      transform: translateY(-1px);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .toggle-btn:hover i {
      transform: scale(1.1);
    }

    .toggle-btn[aria-pressed="true"] {
      background: var(--primary-light);
      color: var(--text);
      border-color: var(--primary);
    }

    .toggle-btn[aria-pressed="true"] i {
      color: var(--text);
    }

    .toggle-btn[aria-pressed="true"]::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(rgba(59, 130, 246, 0.1), transparent);
      opacity: 0;
      transition: opacity var(--transition);
    }

    .toggle-btn[aria-pressed="true"]:hover::before {
      opacity: 1;
    }

    .toggle-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      padding: 1.25rem;
      background: rgba(10, 10, 15, 0.5);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid var(--border);
    }

    .slider-group {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
      padding: 1.25rem;
      background: rgba(10, 10, 15, 0.5);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid var(--border);
    }

    #length-slider {
      flex: 1;
      height: 4px;
      -webkit-appearance: none;
      background: var(--border);
      border-radius: 2px;
      outline: none;
      transition: background var(--transition);
    }

    #length-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      background: var(--primary);
      border-radius: 50%;
      cursor: pointer;
      transition: all var(--transition);
      box-shadow: var(--shadow);
    }

    #length-slider::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      background: var(--primary-hover);
    }

    #length-number {
      width: 4rem;
      font-size: 1rem;
      padding: 0.5rem;
      border: 2px solid var(--border);
      border-radius: var(--radius);
      background: var(--surface);
      color: var(--text);
      text-align: center;
      transition: all var(--transition);
    }

    #length-number:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px var(--primary-light);
    }

    .strength-group {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
      padding: 1.25rem;
      background: rgba(10, 10, 15, 0.5);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid var(--border);
    }

    #strength-meter {
      flex: 1;
      height: 8px;
      background: var(--border);
      border-radius: 4px;
      overflow: hidden;
      transition: background var(--transition);
    }

    #strength-bar {
      height: 100%;
      width: 0%;
      background: var(--danger);
      border-radius: 4px;
      transition: width 0.3s ease, background 0.3s ease;
    }

    #strength-label {
      font-size: 0.95rem;
      font-weight: 600;
      min-width: 80px;
      text-align: right;
      transition: color var(--transition);
    }

    .stats {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      padding: 1.25rem;
      background: var(--bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .stats span {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      min-height: 1.5rem;
    }

    .stats i {
      font-size: 0.9rem;
      color: var(--text-muted);
      width: 1rem;
      text-align: center;
    }

    .stats #counter,
    .stats #last-time {
      font-weight: 600;
      color: var(--text);
      min-width: 2rem;
      display: inline-block;
    }

    .footer-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      margin-top: 2rem;
    }

    .lang-selector {
      position: relative;
    }

    .lang-trigger {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--radius);
      color: var(--text);
      font-size: 0.9rem;
      cursor: pointer;
      transition: all var(--transition);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .lang-trigger:hover {
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.2);
      transform: translateY(-1px);
    }

    .lang-trigger i {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .lang-dropdown {
      position: absolute;
      bottom: 100%;
      left: 0;
      margin-bottom: 0.5rem;
      background: rgba(10, 10, 15, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      min-width: 150px;
      z-index: 100;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    .lang-option {
      display: flex;
      align-items: center;
      width: 100%;
      padding: 0.75rem 1rem;
      background: none;
      border: none;
      color: var(--text);
      font-size: 0.9rem;
      text-align: left;
      cursor: pointer;
      transition: all var(--transition);
    }

    .lang-option:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .lang-option.active {
      color: var(--text);
      background: rgba(255, 255, 255, 0.15);
    }

    .footer-controls a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2.75rem;
      height: 2.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--radius);
      color: var(--text);
      transition: all var(--transition);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .footer-controls a:hover {
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.2);
      transform: translateY(-1px);
    }

    .footer-controls a i {
      font-size: 1.1rem;
    }

    @media (max-width: 640px) {
      main {
        padding: 1.5rem;
      }

      .toggle-group {
        grid-template-columns: 1fr;
      }

      .toggle-btn {
        width: 100%;
      }
    }

    @media (max-width: 480px) {
      body {
        min-height: 100vh;
        height: auto;
        padding: 0.5rem;
        overflow-x: hidden;
      }

      main {
        margin: 0.5rem;
        height: auto;
        overflow-x: hidden;
      }

      .toggle-group {
        grid-template-columns: 1fr;
        gap: 0.5rem;
        padding: 1rem;
      }

      .password-group {
        padding: 0.875rem;
        margin-bottom: 1.25rem;
      }

      #password {
        font-size: 1rem;
        padding: 0.5rem 0.75rem;
      }

      .btn-icon {
        width: 2.25rem;
        height: 2.25rem;
      }

      .btn-icon i {
        font-size: 1rem;
      }

      .slider-group {
        padding: 1rem;
        margin-bottom: 1.25rem;
      }

      .info-panel {
        padding: 1rem;
      }

      .info-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .info-card {
        padding: 1rem;
      }

      .info-card h3 {
        font-size: 1.1rem;
      }

      .info-card p {
        font-size: 0.9rem;
      }

      .tooltip {
        display: none;
      }

      .toggle-btn {
        height: 2.5rem;
        font-size: 0.9rem;
        padding: 0.5rem 0.75rem;
      }

      .toggle-btn i {
        font-size: 1rem;
      }
    }

    @media (max-width: 360px) {
      main {
        padding: 1rem;
      }

      h1 {
        font-size: 1.5rem;
        margin-bottom: 1.25rem;
      }

      .password-group {
        padding: 0.75rem;
      }

      .btn-icon {
        width: 2rem;
        height: 2rem;
      }

      .btn-icon i {
        font-size: 0.9rem;
      }
    }

    /* Add smooth scrolling */
    html {
      scroll-behavior: smooth;
    }

    /* Improve focus styles for accessibility */
    *:focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    /* Update regenerate button animation */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .btn-icon.loading i {
      animation: spin 0.6s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    }

    /* Improve touch targets on mobile */
    @media (hover: none) {
      .btn-icon,
      .toggle-btn {
        min-height: 44px;
      }

      .slider-group input[type="range"] {
        min-height: 44px;
      }
    }

    /* Add subtle hover effect for info cards */
    .info-card {
      transition: transform var(--transition), box-shadow var(--transition);
    }

    .info-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Improve password input readability */
    #password {
      letter-spacing: 0.05em;
      font-weight: 500;
    }

    /* Add subtle animation for strength meter */
    .strength-bar {
      transition: width 0.3s ease, background-color 0.3s ease;
    }

    /* Improve stats section readability */
    .stats {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      padding: 1rem;
      background: rgba(10, 10, 15, 0.5);
      border-radius: var(--radius);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid var(--border);
    }

    .stats span {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .stats i {
      width: 1rem;
      text-align: center;
    }

    .password-group.fallback-active {
      border: 2px solid red !important;
    }

    .info-panel {
      margin-top: 2rem;
      padding: 1.5rem;
      background: rgba(10, 10, 15, 0.5);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid var(--border);
    }

    .info-panel h2 {
      font-size: 1.25rem;
      margin-bottom: 1.5rem;
      color: var(--text);
      text-align: center;
      font-weight: 600;
      letter-spacing: -0.01em;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
    }

    .info-card {
      background: rgba(10, 10, 15, 0.5);
      border-radius: var(--radius);
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      transition: transform var(--transition), box-shadow var(--transition);
      border: 1px solid var(--border);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .info-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
      border-color: var(--border-hover);
    }

    .info-card i {
      font-size: 1.75rem;
      color: var(--primary);
      margin-bottom: 1rem;
      transition: transform var(--transition);
    }

    .info-card:hover i {
      transform: scale(1.1);
    }

    .info-card h3 {
      font-size: 1.1rem;
      margin-bottom: 0.75rem;
      color: var(--text);
      font-weight: 600;
    }

    .info-card p {
      font-size: 0.95rem;
      color: var(--text-muted);
      line-height: 1.5;
    }

    @media (max-width: 640px) {
      .info-grid {
        grid-template-columns: 1fr;
      }
      
      .info-card {
        padding: 1.25rem;
      }
    }

    /* Add toast notification styles */
    .toast {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%) translateY(100%);
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: var(--text);
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius);
      font-size: 0.9rem;
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
    }

    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    /* Add generation animation */
    @keyframes generatePulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }

    .password-group.generating {
      animation: generatePulse 0.3s ease;
    }
  </style>
</head>
<body>
  <main>
    <h1 id="title">Password Generator</h1>
    <div class="password-group">
      <input id="password" type="text" aria-label="Generated password" 
             placeholder="Please select at least one option" />
      <span id="password-placeholder-fallback">Please select at least one option</span>
      <div class="password-actions">
        <button id="copy-btn" type="button" class="btn-icon" aria-label="Copy password">
          <i class="fas fa-clipboard" aria-hidden="true"></i>
        </button>
        <button id="regenerate-btn" type="button" class="btn-icon" aria-label="Regenerate password">
          <i class="fas fa-sync-alt" aria-hidden="true"></i>
        </button>
      </div>
    </div>
    <div class="toggle-group">
      <button type="button" class="toggle-btn" id="lowercase" aria-pressed="true" data-tooltip="Include lowercase letters (a-z)">
        <i class="fas fa-font" aria-hidden="true"></i>
        <span>Lowercase</span>
        <div class="tooltip">Include lowercase letters (a-z)</div>
      </button>
      <button type="button" class="toggle-btn" id="uppercase" aria-pressed="true" data-tooltip="Include uppercase letters (A-Z)">
        <i class="fas fa-font" aria-hidden="true"></i>
        <span>Uppercase</span>
        <div class="tooltip">Include uppercase letters (A-Z)</div>
      </button>
      <button type="button" class="toggle-btn" id="numbers" aria-pressed="true" data-tooltip="Include numbers (0-9)">
        <i class="fas fa-hashtag" aria-hidden="true"></i>
        <span>Numbers</span>
        <div class="tooltip">Include numbers (0-9)</div>
      </button>
      <button type="button" class="toggle-btn" id="symbols" aria-pressed="true" data-tooltip="Include symbols (!@#$%^&*()-_=+~`|:;,.<>?)">
        <i class="fas fa-at" aria-hidden="true"></i>
        <span>Symbols</span>
        <div class="tooltip">Include symbols (!@#$%^&*()-_=+~`|:;,.<>?)</div>
      </button>
    </div>
    <div class="slider-group">
      <label for="length-slider" id="length-label">Length</label>
      <input id="length-slider" type="range" min="8" max="128" value="16" />
      <input id="length-number" type="number" min="8" max="128" value="16" />
    </div>
    <div class="strength-group">
      <div id="strength-meter">
        <div id="strength-bar"></div>
      </div>
      <span id="strength-label">Strength</span>
    </div>
    <div class="stats">
      <span>
        <i class="fas fa-key" aria-hidden="true"></i>
        <span id="passwords-generated-label">Passwords generated:</span> <span id="counter">0</span>
      </span>
      <span>
        <i class="fas fa-clock" aria-hidden="true"></i>
        <span id="last-generated-label">Last generated:</span> <span id="last-time">—</span>
      </span>
    </div>
    <div class="info-panel">
      <h2>What makes a strong password?</h2>
      <div class="info-grid">
        <div class="info-card">
          <i class="fas fa-ruler-horizontal"></i>
          <h3>Long</h3>
          <p>Use at least 12 characters. Longer passwords are exponentially harder to crack.</p>
        </div>
        <div class="info-card">
          <i class="fas fa-layer-group"></i>
          <h3>Complex</h3>
          <p>Mix uppercase and lowercase letters, numbers, and symbols for maximum security.</p>
        </div>
        <div class="info-card">
          <i class="fas fa-fingerprint"></i>
          <h3>Unique</h3>
          <p>Never reuse passwords across different accounts. Each account needs its own strong password.</p>
        </div>
      </div>
    </div>
  </main>
  <footer>
    <div class="footer-controls">
      <div class="lang-selector">
        <button id="lang-trigger" class="lang-trigger" aria-label="Select language">
          <i class="fas fa-globe"></i>
          <span id="current-lang">English</span>
          <i class="fas fa-chevron-down"></i>
        </button>
        <div id="lang-dropdown" class="lang-dropdown" hidden>
          <button class="lang-option" data-lang="en">English</button>
          <button class="lang-option" data-lang="es">Español</button>
          <button class="lang-option" data-lang="fr">Français</button>
          <button class="lang-option" data-lang="tr">Türkçe</button>
        </div>
      </div>
      <a href="https://github.com" target="_blank" rel="noopener noreferrer" aria-label="GitHub repository">
        <i class="fab fa-github" aria-hidden="true"></i>
      </a>
    </div>
  </footer>
  <div class="toast" id="toast">Copied!</div>
  <script>
    // --- i18n translations ---
    const translations = {
      en: {
        title: "Password Generator",
        length: "Length",
        includeLower: "Lowercase",
        includeUpper: "Uppercase",
        includeNumbers: "Numbers",
        includeSymbols: "Symbols",
        excludeChars: "Exclude these characters",
        strength: "Strength",
        weak: "Weak",
        medium: "Medium",
        strong: "Strong",
        excellent: "Excellent",
        copyAria: "Copy password",
        regenerateAria: "Regenerate password",
        password: "Generated password",
        language: "Language",
        passwordsGenerated: "Passwords generated:",
        lastGenerated: "Last generated:",
        strongPasswordTitle: "What makes a strong password?",
        long: "Long",
        longDesc: "Use at least 12 characters. Longer passwords are exponentially harder to crack.",
        complex: "Complex",
        complexDesc: "Mix uppercase and lowercase letters, numbers, and symbols for maximum security.",
        unique: "Unique",
        uniqueDesc: "Never reuse passwords across different accounts. Each account needs its own strong password.",
        copied: "Password copied to clipboard!",
        generated: "New password generated!"
      },
      es: {
        title: "Generador de Contraseñas",
        length: "Longitud",
        includeLower: "Minúsculas",
        includeUpper: "Mayúsculas",
        includeNumbers: "Números",
        includeSymbols: "Símbolos",
        excludeChars: "Excluir estos caracteres",
        strength: "Fortaleza",
        weak: "Débil",
        medium: "Media",
        strong: "Fuerte",
        excellent: "Excelente",
        copyAria: "Copiar contraseña",
        regenerateAria: "Regenerar contraseña",
        password: "Contraseña generada",
        language: "Idioma",
        passwordsGenerated: "Contraseñas generadas:",
        lastGenerated: "Última generación:",
        strongPasswordTitle: "¿Qué hace una contraseña fuerte?",
        long: "Larga",
        longDesc: "Usa al menos 12 caracteres. Las contraseñas más largas son exponencialmente más difíciles de descifrar.",
        complex: "Compleja",
        complexDesc: "Combina letras mayúsculas y minúsculas, números y símbolos para máxima seguridad.",
        unique: "Única",
        uniqueDesc: "Nunca reutilices contraseñas en diferentes cuentas. Cada cuenta necesita su propia contraseña fuerte.",
        copied: "¡Contraseña copiada al portapapeles!",
        generated: "¡Nueva contraseña generada!"
      },
      fr: {
        title: "Générateur de Mot de Passe",
        length: "Longueur",
        includeLower: "Minuscules",
        includeUpper: "Majuscules",
        includeNumbers: "Chiffres",
        includeSymbols: "Symboles",
        excludeChars: "Exclure ces caractères",
        strength: "Robustesse",
        weak: "Faible",
        medium: "Moyenne",
        strong: "Forte",
        excellent: "Excellente",
        copyAria: "Copier le mot de passe",
        regenerateAria: "Régénérer le mot de passe",
        password: "Mot de passe généré",
        language: "Langue",
        passwordsGenerated: "Mots de passe générés :",
        lastGenerated: "Dernière génération :",
        strongPasswordTitle: "Qu'est-ce qu'un mot de passe fort ?",
        long: "Long",
        longDesc: "Utilisez au moins 12 caractères. Les mots de passe plus longs sont exponentiellement plus difficiles à craquer.",
        complex: "Complexe",
        complexDesc: "Mélangez majuscules et minuscules, chiffres et symboles pour une sécurité maximale.",
        unique: "Unique",
        uniqueDesc: "Ne réutilisez jamais les mots de passe sur différents comptes. Chaque compte a besoin de son propre mot de passe fort.",
        copied: "Mot de passe copié dans le presse-papiers !",
        generated: "Nouveau mot de passe généré !"
      },
      tr: {
        title: "Şifre Oluşturucu",
        length: "Uzunluk",
        includeLower: "Küçük Harf",
        includeUpper: "Büyük Harf",
        includeNumbers: "Rakamlar",
        includeSymbols: "Semboller",
        excludeChars: "Bu karakterleri hariç tut",
        strength: "Güç",
        weak: "Zayıf",
        medium: "Orta",
        strong: "Güçlü",
        excellent: "Mükemmel",
        copyAria: "Şifreyi kopyala",
        regenerateAria: "Şifreyi yeniden oluştur",
        password: "Oluşturulan şifre",
        language: "Dil",
        passwordsGenerated: "Oluşturulan şifre sayısı:",
        lastGenerated: "Son oluşturulma:",
        strongPasswordTitle: "Güçlü bir şifre ne yapar?",
        long: "Uzun",
        longDesc: "En az 12 karakter kullanın. Daha uzun şifreler kırılması üstel olarak daha zordur.",
        complex: "Karmaşık",
        complexDesc: "Maksimum güvenlik için büyük ve küçük harfleri, rakamları ve sembolleri karıştırın.",
        unique: "Benzersiz",
        uniqueDesc: "Farklı hesaplarda şifreleri asla yeniden kullanmayın. Her hesabın kendi güçlü şifresine ihtiyacı vardır.",
        copied: "Şifre panoya kopyalandı!",
        generated: "Yeni şifre oluşturuldu!"
      }
    };

    // --- DOM elements ---
    const $ = id => document.getElementById(id);
    const passwordEl = $("password");
    const copyBtn = $("copy-btn");
    const regenerateBtn = $("regenerate-btn");
    const lengthSlider = $("length-slider");
    const lengthNumber = $("length-number");
    const lowercaseEl = $("lowercase");
    const uppercaseEl = $("uppercase");
    const numbersEl = $("numbers");
    const symbolsEl = $("symbols");
    const strengthBar = $("strength-bar");
    const strengthLabel = $("strength-label");
    const counterEl = $("counter");
    const lastTimeEl = $("last-time");
    const langTrigger = $("lang-trigger");
    const langDropdown = $("lang-dropdown");
    const currentLangEl = $("current-lang");
    const titleEl = $("title");
    const lengthLabel = $("length-label");
    const placeholderFallback = $("password-placeholder-fallback");
    const passwordGroup = document.querySelector('.password-group');
    const toast = $("toast");

    // --- State ---
    let passwordCount = parseInt(localStorage.getItem('pwdgen-count') || '0', 10);
    let lastGenerated = localStorage.getItem('pwdgen-last') || null;
    let currentLang = localStorage.getItem('pwdgen-lang') || 'en';
    let copyTimeout = null;
    let isInitialized = false;

    // --- User preferences ---
    const defaultPreferences = {
      length: 16,
      options: {
        lower: true,
        upper: true,
        number: true,
        symbol: true
      }
    };

    function savePreferences() {
      const preferences = {
        length: parseInt(lengthSlider.value, 10),
        options: {
          lower: lowercaseEl.getAttribute('aria-pressed') === 'true',
          upper: uppercaseEl.getAttribute('aria-pressed') === 'true',
          number: numbersEl.getAttribute('aria-pressed') === 'true',
          symbol: symbolsEl.getAttribute('aria-pressed') === 'true'
        }
      };
      localStorage.setItem('pwdgen-preferences', JSON.stringify(preferences));
    }

    function loadPreferences() {
      try {
        const saved = localStorage.getItem('pwdgen-preferences');
        if (saved) {
          const preferences = JSON.parse(saved);
          // Set length
          syncLengthInputs(preferences.length);
          // Set options
          lowercaseEl.setAttribute('aria-pressed', preferences.options.lower);
          uppercaseEl.setAttribute('aria-pressed', preferences.options.upper);
          numbersEl.setAttribute('aria-pressed', preferences.options.number);
          symbolsEl.setAttribute('aria-pressed', preferences.options.symbol);
          return true;
        }
      } catch (e) {
        console.warn('Failed to load preferences:', e);
      }
      return false;
    }

    // --- Character sets ---
    const CHARS = {
      lower: "abcdefghijklmnopqrstuvwxyz",
      upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
      number: "0123456789",
      symbol: "!@#$%^&*()-_=+~`|:;,.<>?"
    };

    // --- Utility functions ---
    function getCharset(opts) {
      let chars = "";
      if (opts.lower) chars += CHARS.lower;
      if (opts.upper) chars += CHARS.upper;
      if (opts.number) chars += CHARS.number;
      if (opts.symbol) chars += CHARS.symbol;
      return chars;
    }

    function generatePassword(length, opts) {
      const charset = getCharset(opts);
      if (!charset) return "";
      const charsetArr = charset.split("");
      const result = [];
      const randomBytes = new Uint32Array(length);
      window.crypto.getRandomValues(randomBytes);
      for (let i = 0; i < length; i++) {
        const idx = randomBytes[i] % charsetArr.length;
        result.push(charsetArr[idx]);
      }
      let required = [];
      if (opts.lower) required.push(CHARS.lower);
      if (opts.upper) required.push(CHARS.upper);
      if (opts.number) required.push(CHARS.number);
      if (opts.symbol) required.push(CHARS.symbol);
      for (let i = 0; i < required.length; i++) {
        if (!required[i]) continue;
        const set = required[i];
        if (!result.some(c => set.includes(c))) {
          let pos = Math.floor(Math.random() * length);
          let char = set[Math.floor(Math.random() * set.length)];
          result[pos] = char;
        }
      }
      return result.join("");
    }

    function estimateStrength(pw, opts) {
      const charset = getCharset(opts);
      if (!pw || !charset) return {score: 0, label: translations[currentLang].weak, color: "var(--danger)"};
      let entropy = Math.log2(charset.length) * pw.length;
      if (entropy < 40) return {score: 1, label: translations[currentLang].weak, color: "var(--danger)"};
      if (entropy < 60) return {score: 2, label: translations[currentLang].medium, color: "var(--warning)"};
      if (entropy < 80) return {score: 3, label: translations[currentLang].strong, color: "var(--success)"};
      return {score: 4, label: translations[currentLang].excellent, color: "var(--excellent)"};
    }

    function updateStrengthMeter(pw, opts) {
      const {score, label, color} = estimateStrength(pw, opts);
      const widths = [0, 30, 55, 80, 100];
      strengthBar.style.width = widths[score] + "%";
      strengthBar.style.background = color;
      strengthLabel.textContent = label;
      strengthLabel.style.color = color;
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      // Clear any existing timeouts
      if (toast.timeout) {
        clearTimeout(toast.timeout);
      }
      // Reset the toast state
      toast.classList.remove('show');
      // Force a reflow
      void toast.offsetWidth;
      // Set the new message
      toast.textContent = message;
      // Show the toast
      toast.classList.add('show');
      // Set the timeout to hide it
      toast.timeout = setTimeout(() => {
        toast.classList.remove('show');
        toast.timeout = null;
      }, 2000);
    }

    function showCopySuccess() {
      const copyBtn = document.getElementById('copy-btn');
      copyBtn.classList.add('success');
      copyBtn.innerHTML = '<i class="fas fa-check" aria-hidden="true"></i>';
      showToast(translations[currentLang].copied);
      setTimeout(() => {
        copyBtn.classList.remove('success');
        copyBtn.innerHTML = '<i class="fas fa-clipboard" aria-hidden="true"></i>';
      }, 1500);
    }

    function handleRegenerate() {
      const regenerateBtn = document.getElementById('regenerate-btn');
      regenerateBtn.classList.add('loading');
      doGenerate();
      showToast(translations[currentLang].generated);
      setTimeout(() => {
        regenerateBtn.classList.remove('loading');
      }, 600);
    }

    function syncLengthInputs(val) {
      lengthSlider.value = val;
      lengthNumber.value = val;
    }

    function getOptions() {
      const opts = {
        lower: lowercaseEl.getAttribute('aria-pressed') === 'true',
        upper: uppercaseEl.getAttribute('aria-pressed') === 'true',
        number: numbersEl.getAttribute('aria-pressed') === 'true',
        symbol: symbolsEl.getAttribute('aria-pressed') === 'true'
      };
      return opts;
    }

    function nowTimeString() {
      const d = new Date();
      return d.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit', second: '2-digit'});
    }

    function updateI18n() {
      const t = translations[currentLang];
      
      // Update main elements
      titleEl.textContent = t.title;
      lengthLabel.textContent = t.length;
      strengthLabel.textContent = t.strength;
      copyBtn.setAttribute("aria-label", t.copyAria);
      document.getElementById('regenerate-btn').setAttribute("aria-label", t.regenerateAria);
      passwordEl.setAttribute("aria-label", t.password);
      currentLangEl.textContent = t.language;
      
      // Update stats labels
      const passwordsGeneratedLabel = document.getElementById('passwords-generated-label');
      const lastGeneratedLabel = document.getElementById('last-generated-label');
      
      if (passwordsGeneratedLabel) {
        passwordsGeneratedLabel.textContent = t.passwordsGenerated;
        console.log('Updated passwords generated label:', t.passwordsGenerated);
      }
      
      if (lastGeneratedLabel) {
        lastGeneratedLabel.textContent = t.lastGenerated;
        console.log('Updated last generated label:', t.lastGenerated);
      }
      
      // Update toggle buttons
      const toggles = {
        lowercase: t.includeLower,
        uppercase: t.includeUpper,
        numbers: t.includeNumbers,
        symbols: t.includeSymbols
      };
      
      Object.entries(toggles).forEach(([id, text]) => {
        const btn = document.getElementById(id);
        if (btn) {
          const span = btn.querySelector('span');
          if (span) span.textContent = text;
        }
      });
      
      // Update info panel
      const infoPanel = document.querySelector('.info-panel');
      if (infoPanel) {
        infoPanel.querySelector('h2').textContent = t.strongPasswordTitle;
        const cards = infoPanel.querySelectorAll('.info-card');
        if (cards.length >= 3) {
          cards[0].querySelector('h3').textContent = t.long;
          cards[0].querySelector('p').textContent = t.longDesc;
          cards[1].querySelector('h3').textContent = t.complex;
          cards[1].querySelector('p').textContent = t.complexDesc;
          cards[2].querySelector('h3').textContent = t.unique;
          cards[2].querySelector('p').textContent = t.uniqueDesc;
        }
      }
      
      // Update strength meter if password exists
      if (passwordEl.value) {
        updateStrengthMeter(passwordEl.value, getOptions());
      }
    }

    function updateStats() {
      const counterEl = document.getElementById('counter');
      const lastTimeEl = document.getElementById('last-time');
      
      console.log('Updating stats:', { passwordCount, lastGenerated });
      console.log('Found elements:', { 
        counter: !!counterEl, 
        lastTime: !!lastTimeEl 
      });
      
      if (counterEl) {
        counterEl.textContent = passwordCount;
        console.log('Updated counter:', passwordCount);
      } else {
        console.warn('Counter element not found');
      }
      
      if (lastTimeEl) {
        lastTimeEl.textContent = lastGenerated || "—";
        console.log('Updated last time:', lastGenerated);
      } else {
        console.warn('Last time element not found');
      }
      
      // Save to localStorage
      try {
        localStorage.setItem('pwdgen-count', passwordCount.toString());
        localStorage.setItem('pwdgen-last', lastGenerated);
        console.log('Stats saved to localStorage');
      } catch (e) {
        console.warn('Failed to save to localStorage:', e);
      }
    }

    function showNoOptionsState() {
      passwordEl.value = '';
      passwordEl.placeholder = '';
      if (placeholderFallback) {
        placeholderFallback.style.display = 'block';
        console.log('SHOW FALLBACK');
      }
      if (passwordGroup) {
        passwordGroup.classList.add('fallback-active');
      }
      strengthBar.style.width = '0%';
      strengthBar.style.background = 'var(--text-muted)';
      strengthLabel.textContent = translations[currentLang].weak;
      strengthLabel.style.color = 'var(--text-muted)';
      updateCopyButton();
    }

    function calculateEntropy(password, opts) {
      if (!password || !opts) return 0;
      let charsetSize = 0;
      if (opts.lower) charsetSize += 26;
      if (opts.upper) charsetSize += 26;
      if (opts.number) charsetSize += 10;
      if (opts.symbol) charsetSize += 32; // Common symbols
      return Math.log2(Math.pow(charsetSize, password.length));
    }

    function togglePasswordVisibility() {
      const password = document.getElementById('password');
      const visibilityBtn = document.getElementById('visibility-btn');
      const icon = visibilityBtn.querySelector('i');
      
      password.classList.toggle('visible');
      if (password.classList.contains('visible')) {
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
      } else {
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
      }
    }

    function doGenerate() {
      const passwordGroup = document.querySelector('.password-group');
      passwordGroup.classList.add('generating');
      
      const length = parseInt(lengthSlider.value, 10);
      const opts = getOptions();
      if (!opts.lower && !opts.upper && !opts.number && !opts.symbol) {
        showNoOptionsState();
      } else {
        passwordEl.value = generatePassword(length, opts);
        passwordEl.placeholder = '';
        if (placeholderFallback) {
          placeholderFallback.style.display = 'none';
        }
        if (passwordGroup) {
          passwordGroup.classList.remove('fallback-active');
        }
        updateStrengthMeter(passwordEl.value, opts);
        passwordCount++;
        lastGenerated = nowTimeString();
        updateStats();
        updateCopyButton();
        attachCopyHandler();
      }
      
      setTimeout(() => {
        passwordGroup.classList.remove('generating');
      }, 300);
    }

    function updateCopyButton() {
      const copyBtnCurrent = document.getElementById('copy-btn');
      if (passwordEl.value && passwordEl.value.length > 0) {
        copyBtnCurrent.disabled = false;
        copyBtnCurrent.setAttribute('aria-disabled', 'false');
        copyBtnCurrent.style.opacity = '1';
        copyBtnCurrent.style.cursor = 'pointer';
      } else {
        copyBtnCurrent.disabled = true;
        copyBtnCurrent.setAttribute('aria-disabled', 'true');
        copyBtnCurrent.style.opacity = '0.5';
        copyBtnCurrent.style.cursor = 'not-allowed';
      }
    }

    function attachCopyHandler() {
      const copyBtnCurrent = document.getElementById('copy-btn');
      copyBtnCurrent.onclick = async () => {
        if (!passwordEl.value || copyBtnCurrent.disabled) return;
        try {
          await navigator.clipboard.writeText(passwordEl.value);
          showCopySuccess();
        } catch {
          passwordEl.select();
          document.execCommand('copy');
          showCopySuccess();
        }
      };
    }

    // --- Initialization ---
    function init() {
      if (isInitialized) return;
      
      // Load saved stats
      try {
        const savedCount = localStorage.getItem('pwdgen-count');
        const savedLast = localStorage.getItem('pwdgen-last');
        if (savedCount) passwordCount = parseInt(savedCount, 10);
        if (savedLast) lastGenerated = savedLast;
      } catch (e) {}

      // Set up toggle buttons
      const toggleButtons = [
        { id: 'lowercase', el: lowercaseEl },
        { id: 'uppercase', el: uppercaseEl },
        { id: 'numbers', el: numbersEl },
        { id: 'symbols', el: symbolsEl }
      ];

      toggleButtons.forEach(({ id, el }) => {
        if (!el) return;
        
        // Set initial state
        const isActive = el.getAttribute('aria-pressed') === 'true';
        el.classList.toggle('active', isActive);
        
        // Add click handler
        el.addEventListener('click', () => {
          const currentState = el.getAttribute('aria-pressed') === 'true';
          const newState = !currentState;
          
          // Update button state
          el.setAttribute('aria-pressed', newState);
          el.classList.toggle('active', newState);
          
          // Generate new password if any option is selected
          const opts = getOptions();
          if (opts.lower || opts.upper || opts.number || opts.symbol) {
            doGenerate();
          } else {
            showNoOptionsState();
          }
          
          // Save preferences
          savePreferences();
        });
      });

      // Load preferences or use defaults
      if (!loadPreferences()) {
        // Set default length
        syncLengthInputs(defaultPreferences.length);
        
        // Set default options
        toggleButtons.forEach(({ id, el }) => {
          if (el) {
            const isActive = defaultPreferences.options[id.replace('s', '')];
            el.setAttribute('aria-pressed', isActive);
            el.classList.toggle('active', isActive);
          }
        });
      }

      // Set up length controls
      if (lengthSlider && lengthNumber) {
        lengthSlider.addEventListener("input", e => {
          syncLengthInputs(e.target.value);
          const opts = getOptions();
          if (opts.lower || opts.upper || opts.number || opts.symbol) {
            doGenerate();
          } else {
            showNoOptionsState();
          }
          savePreferences();
        });

        lengthNumber.addEventListener("input", e => {
          syncLengthInputs(e.target.value);
          const opts = getOptions();
          if (opts.lower || opts.upper || opts.number || opts.symbol) {
            doGenerate();
          } else {
            showNoOptionsState();
          }
          savePreferences();
        });
      }

      // Set up regenerate button
      if (regenerateBtn) {
        regenerateBtn.addEventListener('click', handleRegenerate);
      }

      // Set up copy button
      if (copyBtn) {
        copyBtn.addEventListener('click', async () => {
          if (!passwordEl.value || copyBtn.disabled) return;
          try {
            await navigator.clipboard.writeText(passwordEl.value);
            showCopySuccess();
          } catch {
            passwordEl.select();
            document.execCommand('copy');
            showCopySuccess();
          }
        });
      }

      // Update UI
      updateStats();
      updateI18n();
      
      // Generate initial password
      const opts = getOptions();
      if (opts.lower || opts.upper || opts.number || opts.symbol) {
        doGenerate();
      } else {
        showNoOptionsState();
      }
      
      updateCopyButton();
      isInitialized = true;
    }

    // --- Event listeners ---
    // Language selector
    langTrigger.addEventListener('click', (e) => {
      e.stopPropagation();
      langDropdown.hidden = !langDropdown.hidden;
    });

    document.querySelectorAll('.lang-option').forEach(option => {
      option.addEventListener('click', () => {
        currentLang = option.dataset.lang;
        currentLangEl.textContent = option.textContent;
        langDropdown.hidden = true;
        localStorage.setItem('pwdgen-lang', currentLang);
        updateI18n();
      });
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', (e) => {
      if (!langTrigger.contains(e.target) && !langDropdown.contains(e.target)) {
        langDropdown.hidden = true;
      }
    });

    // Add regenerate button handler
    document.getElementById('regenerate-btn').addEventListener('click', handleRegenerate);

    // Add tooltip positioning
    document.querySelectorAll('.toggle-btn').forEach(btn => {
      const tooltip = btn.querySelector('.tooltip');
      if (tooltip) {
        btn.addEventListener('mouseenter', () => {
          const rect = btn.getBoundingClientRect();
          tooltip.style.left = `${rect.width / 2}px`;
          tooltip.style.top = `${rect.height + 8}px`;
        });
      }
    });

    // Start the app when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>
</html> 