<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Password Generator - Secure & Modern</title>
  <meta name="description"
    content="Generate strong, secure passwords with our modern password generator. Customizable length and character options.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    :root {
      /* HIBP-style Dark Theme */
      --bg-primary: #050508;
      --bg-secondary: #0a0a0f;
      --bg-card: rgba(255, 255, 255, 0.03);
      --bg-card-hover: rgba(255, 255, 255, 0.06);

      /* Accent Colors - Purple/Indigo Gradient */
      --accent-primary: #6366f1;
      --accent-secondary: #8b5cf6;
      --accent-tertiary: #a855f7;
      --accent-hover: #4f46e5;
      --accent-glow: rgba(99, 102, 241, 0.4);
      --accent-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);

      /* Text Colors */
      --text-primary: #fafafa;
      --text-secondary: #a1a1aa;
      --text-muted: #71717a;

      /* Border Colors */
      --border-color: rgba(255, 255, 255, 0.06);
      --border-glow: rgba(99, 102, 241, 0.5);

      /* Status Colors */
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
      --excellent: #06d6a0;

      /* Glass Effect */
      --glass-bg: rgba(255, 255, 255, 0.02);
      --glass-border: rgba(255, 255, 255, 0.08);

      /* Sizing */
      --radius: 16px;
      --radius-lg: 24px;
      --radius-full: 9999px;
      --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.35);
      --shadow-sm: 0 2px 8px 0 rgba(99, 102, 241, 0.1);
      --transition: 0.25s cubic-bezier(0.4, 0, 0.2, 1);

      /* Fonts */
      --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      --font-mono: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--font-sans);
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
      overflow-x: hidden;
      letter-spacing: -0.01em;
    }

    /* Premium noise texture overlay */
    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.02;
      pointer-events: none;
      z-index: 1000;
    }

    /* Animated gradient orbs */
    .orb {
      position: fixed;
      border-radius: 50%;
      filter: blur(80px);
      pointer-events: none;
      z-index: 0;
    }

    .orb-1 {
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(99, 102, 241, 0.3) 0%, transparent 70%);
      top: -200px;
      left: -100px;
      animation: float-1 20s ease-in-out infinite;
    }

    .orb-2 {
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, rgba(139, 92, 246, 0.25) 0%, transparent 70%);
      top: 30%;
      right: -150px;
      animation: float-2 25s ease-in-out infinite;
    }

    .orb-3 {
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(168, 85, 247, 0.2) 0%, transparent 70%);
      bottom: -100px;
      left: 30%;
      animation: float-3 18s ease-in-out infinite;
    }

    @keyframes float-1 {

      0%,
      100% {
        transform: translate(0, 0) scale(1);
      }

      33% {
        transform: translate(50px, 30px) scale(1.05);
      }

      66% {
        transform: translate(-30px, 50px) scale(0.95);
      }
    }

    @keyframes float-2 {

      0%,
      100% {
        transform: translate(0, 0) scale(1);
      }

      33% {
        transform: translate(-40px, -50px) scale(1.1);
      }

      66% {
        transform: translate(30px, 20px) scale(0.9);
      }
    }

    @keyframes float-3 {

      0%,
      100% {
        transform: translate(0, 0) scale(1);
      }

      50% {
        transform: translate(60px, -40px) scale(1.08);
      }
    }

    /* Navigation */
    .nav {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(5, 5, 8, 0.7);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border-bottom: 1px solid var(--glass-border);
    }

    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 72px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 14px;
      text-decoration: none;
      transition: transform 0.3s ease;
    }

    .brand:hover {
      transform: scale(1.02);
    }

    .brand-icon {
      width: 42px;
      height: 42px;
      background: var(--accent-gradient);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 1.1rem;
      color: white;
      box-shadow: 0 4px 20px var(--accent-glow), inset 0 1px 0 rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
    }

    .brand-icon::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%) rotate(45deg);
      }

      100% {
        transform: translateX(100%) rotate(45deg);
      }
    }

    .brand-text {
      font-weight: 700;
      font-size: 1.4rem;
      background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -0.02em;
    }

    .nav-controls {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    /* Hero Section */
    .hero {
      position: relative;
      z-index: 1;
      padding: 60px 24px 40px;
      text-align: center;
    }

    .hero-container {
      max-width: 600px;
      margin: 0 auto;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      padding: 10px 20px;
      border-radius: 100px;
      font-size: 0.875rem;
      color: var(--text-secondary);
      font-weight: 500;
      margin-bottom: 32px;
      backdrop-filter: blur(10px);
      animation: fadeInDown 0.8s ease-out;
    }

    .hero-badge-dot {
      width: 8px;
      height: 8px;
      background: var(--success);
      border-radius: 50%;
      box-shadow: 0 0 12px var(--success);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
        box-shadow: 0 0 12px var(--success);
      }

      50% {
        opacity: 0.6;
        box-shadow: 0 0 20px var(--success), 0 0 40px var(--success);
      }
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .hero h1 {
      font-size: clamp(2.5rem, 6vw, 3.5rem);
      font-weight: 800;
      line-height: 1.1;
      margin-bottom: 20px;
      letter-spacing: -0.04em;
      background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-primary) 40%, var(--accent-primary) 60%, var(--accent-secondary) 80%, var(--accent-tertiary) 100%);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: fadeInUp 0.8s ease-out 0.1s backwards, gradientShift 8s ease infinite;
    }

    @keyframes gradientShift {

      0%,
      100% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }
    }

    .hero p {
      font-size: 1.15rem;
      color: var(--text-secondary);
      max-width: 500px;
      margin: 0 auto 32px;
      line-height: 1.7;
      animation: fadeInUp 0.8s ease-out 0.2s backwards;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Main Generator Card */
    .generator-section {
      position: relative;
      z-index: 1;
      padding: 0 24px 60px;
    }

    .generator-card {
      max-width: 550px;
      margin: 0 auto;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      padding: 2rem;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      box-shadow: var(--shadow);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .generator-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .generator-card:hover {
      border-color: var(--border-glow);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4), 0 0 60px var(--accent-glow);
    }

    .generator-card:hover::before {
      opacity: 1;
    }

    /* Password Display */
    .password-group {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      background: rgba(0, 0, 0, 0.3);
      border: 1.5px solid var(--glass-border);
      border-radius: var(--radius);
      padding: 1.25rem;
      position: relative;
      transition: border var(--transition), box-shadow var(--transition);
    }

    .password-group:focus-within {
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
    }

    #password {
      flex: 1;
      font-size: 1.2rem;
      font-family: var(--font-mono);
      padding: 0.5rem;
      border: none;
      background: transparent;
      color: var(--text-primary);
      outline: none;
      min-width: 0;
      user-select: all;
      letter-spacing: 0.03em;
      font-weight: 500;
    }

    #password::placeholder {
      color: var(--text-muted);
      font-style: italic;
      font-size: 0.9em;
      font-family: var(--font-sans);
    }

    #password-placeholder-fallback {
      display: none;
      position: absolute;
      left: 1.25rem;
      right: 7rem;
      color: var(--text-muted);
      font-style: italic;
      font-size: 0.95rem;
      pointer-events: none;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .password-group.fallback-active #password-placeholder-fallback {
      display: block;
    }

    .password-group.fallback-active #password {
      opacity: 0;
    }

    .password-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2.75rem;
      height: 2.75rem;
      border: none;
      border-radius: var(--radius-full);
      background: rgba(99, 102, 241, 0.15);
      color: var(--accent-primary);
      cursor: pointer;
      transition: all var(--transition);
      font-size: 1.1rem;
    }

    .btn-icon:hover:not(:disabled) {
      background: var(--accent-primary);
      color: #fff;
      transform: scale(1.05);
      box-shadow: 0 4px 20px var(--accent-glow);
    }

    .btn-icon:focus-visible {
      outline: 2px solid var(--accent-primary);
      outline-offset: 2px;
    }

    .btn-icon.success {
      background: var(--success);
      color: #fff;
    }

    .btn-icon:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #regenerate-btn.spinning i {
      animation: spin 0.5s ease-out;
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* Toggle Buttons */
    .toggle-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .toggle-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.7rem;
      padding: 1rem 1.25rem;
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-full);
      background: rgba(255, 255, 255, 0.03);
      color: var(--text-muted);
      font-size: 0.95rem;
      font-weight: 500;
      font-family: var(--font-sans);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      outline: none;
      position: relative;
      overflow: hidden;
    }

    .toggle-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: var(--accent-gradient);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .toggle-btn i,
    .toggle-btn span {
      position: relative;
      z-index: 1;
    }

    .toggle-btn i {
      font-size: 0.9rem;
      transition: transform 0.3s ease;
    }

    .toggle-btn .tooltip {
      display: none;
    }

    .toggle-btn[aria-pressed="true"] {
      border-color: transparent;
      color: #fff;
      box-shadow: 0 4px 20px var(--accent-glow), 0 0 0 1px rgba(99, 102, 241, 0.3);
    }

    .toggle-btn[aria-pressed="true"]::before {
      opacity: 1;
    }

    .toggle-btn[aria-pressed="true"] i {
      transform: scale(1.1);
    }

    .toggle-btn:hover:not([aria-pressed="true"]) {
      background: rgba(99, 102, 241, 0.08);
      border-color: rgba(99, 102, 241, 0.4);
      color: var(--text-primary);
      transform: translateY(-2px);
    }

    .toggle-btn:active {
      transform: scale(0.98);
    }

    /* Slider Group */
    .slider-group {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
      padding: 1rem 1.25rem;
      background: rgba(0, 0, 0, 0.2);
      border-radius: var(--radius);
      border: 1.5px solid var(--glass-border);
    }

    .slider-group label {
      font-weight: 500;
      color: var(--text-secondary);
      min-width: 60px;
    }

    #length-slider {
      flex: 1;
      height: 8px;
      -webkit-appearance: none;
      appearance: none;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      outline: none;
      cursor: pointer;
      position: relative;
    }

    #length-slider::-webkit-slider-runnable-track {
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    #length-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-tertiary));
      border-radius: 50%;
      cursor: pointer;
      margin-top: -4px;
      box-shadow: 0 2px 8px var(--accent-glow), 0 0 0 2px rgba(255, 255, 255, 0.9);
      transition: all 0.2s ease;
      border: none;
    }

    #length-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 3px 12px var(--accent-glow), 0 0 0 3px rgba(255, 255, 255, 1);
    }

    #length-slider::-moz-range-track {
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    #length-slider::-moz-range-progress {
      height: 8px;
      background: linear-gradient(to right, var(--accent-primary), var(--accent-tertiary));
      border-radius: 4px;
    }

    #length-slider::-moz-range-thumb {
      width: 16px;
      height: 16px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-tertiary));
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 8px var(--accent-glow), 0 0 0 2px rgba(255, 255, 255, 0.9);
      border: none;
    }

    #length-number {
      width: 4rem;
      font-size: 1rem;
      padding: 0.5rem;
      border: 1.5px solid var(--glass-border);
      border-radius: var(--radius);
      background: rgba(0, 0, 0, 0.3);
      color: var(--text-primary);
      text-align: center;
      transition: all var(--transition);
    }

    #length-number:focus {
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
      outline: none;
    }

    /* Strength Meter */
    .strength-group {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
      padding: 1rem 1.25rem;
      background: rgba(0, 0, 0, 0.2);
      border-radius: var(--radius);
      border: 1.5px solid var(--glass-border);
    }

    #strength-meter {
      flex: 1;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      overflow: hidden;
      position: relative;
    }

    #strength-bar {
      height: 100%;
      width: 0%;
      background: var(--danger);
      border-radius: 4px;
      transition: width 0.4s ease, background 0.4s ease, box-shadow 0.4s ease;
    }

    #strength-bar.glow-danger {
      box-shadow:
        0 0 10px 3px var(--danger),
        0 0 20px 6px rgba(239, 68, 68, 0.5),
        0 0 30px 10px rgba(239, 68, 68, 0.2);
    }

    #strength-bar.glow-warning {
      box-shadow:
        0 0 10px 3px var(--warning),
        0 0 20px 6px rgba(245, 158, 11, 0.5),
        0 0 30px 10px rgba(245, 158, 11, 0.2);
    }

    #strength-bar.glow-success {
      box-shadow:
        0 0 10px 3px var(--success),
        0 0 20px 6px rgba(34, 197, 94, 0.5),
        0 0 30px 10px rgba(34, 197, 94, 0.2);
    }

    #strength-bar.glow-excellent {
      box-shadow:
        0 0 12px 4px var(--excellent),
        0 0 25px 8px rgba(139, 92, 246, 0.6),
        0 0 40px 15px rgba(139, 92, 246, 0.3);
    }

    #strength-label {
      font-size: 0.95rem;
      font-weight: 600;
      min-width: 80px;
      text-align: right;
      transition: color var(--transition);
    }

    /* Security Info */
    .security-info {
      display: flex;
      justify-content: space-between;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .security-card {
      flex: 1;
      padding: 1rem;
      background: rgba(0, 0, 0, 0.2);
      border-radius: var(--radius);
      border: 1.5px solid var(--glass-border);
      text-align: center;
    }

    .security-card-label {
      display: block;
      font-size: 0.75rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.4rem;
    }

    .security-card-value {
      display: block;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text-primary);
      font-family: var(--font-mono);
    }

    .security-card-value.entropy {
      color: var(--accent-primary);
    }

    .security-card-value.crack-time {
      color: var(--success);
    }

    /* Stats */
    .stats {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.25rem;
      background: rgba(0, 0, 0, 0.2);
      border-radius: var(--radius);
      border: 1.5px solid var(--glass-border);
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .stat-value {
      font-weight: 700;
      color: var(--accent-primary);
      font-size: 1rem;
    }

    .stat-hint {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      opacity: 0.7;
      font-size: 0.8rem;
    }

    .stats i {
      color: var(--accent-primary);
    }

    kbd {
      display: inline-block;
      padding: 0.2rem 0.5rem;
      font-size: 0.75rem;
      font-family: var(--font-mono);
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--glass-border);
      border-radius: 6px;
      box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
    }

    /* Toggle Icon */
    .toggle-icon {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      font-weight: 700;
      padding: 0.25rem 0.5rem;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 6px;
      letter-spacing: -0.02em;
    }

    .toggle-btn[aria-pressed="true"] .toggle-icon {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Info Panel */
    .info-section {
      position: relative;
      z-index: 1;
      padding: 0 24px 80px;
    }

    .info-panel {
      max-width: 550px;
      margin: 0 auto;
      padding: 2rem;
      background: var(--glass-bg);
      border-radius: var(--radius-lg);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
    }

    .info-panel h2 {
      font-size: 1.5rem;
      margin-bottom: 2rem;
      color: var(--text-primary);
      text-align: center;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .info-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .info-card {
      background: rgba(0, 0, 0, 0.2);
      border-radius: var(--radius);
      padding: 1.75rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid var(--glass-border);
    }

    .info-card:hover {
      transform: translateY(-8px);
      border-color: var(--border-glow);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3), 0 0 40px var(--accent-glow);
    }

    .info-card i {
      font-size: 2rem;
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1rem;
      transition: transform var(--transition);
    }

    .info-card:hover i {
      transform: scale(1.15);
    }

    .info-card h3 {
      font-size: 1.15rem;
      margin-bottom: 0.75rem;
      color: var(--text-primary);
      font-weight: 600;
    }

    .info-card p {
      font-size: 0.95rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    /* Footer */
    .footer {
      position: relative;
      z-index: 1;
      padding: 40px 24px;
      border-top: 1px solid var(--glass-border);
    }

    .footer-container {
      max-width: 600px;
      margin: 0 auto;
      text-align: center;
    }

    .footer-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .lang-selector {
      position: relative;
    }

    .lang-trigger {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-full);
      color: var(--text-secondary);
      font-size: 0.9rem;
      cursor: pointer;
      transition: all var(--transition);
    }

    .lang-trigger:hover {
      background: rgba(99, 102, 241, 0.1);
      border-color: var(--accent-primary);
      color: var(--text-primary);
    }

    .lang-dropdown {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      margin-bottom: 0.5rem;
      background: rgba(10, 10, 15, 0.95);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      min-width: 150px;
      z-index: 100;
      backdrop-filter: blur(20px);
      overflow: hidden;
    }

    .lang-option {
      display: block;
      width: 100%;
      padding: 0.75rem 1rem;
      background: none;
      border: none;
      color: var(--text-secondary);
      font-size: 0.9rem;
      text-align: left;
      cursor: pointer;
      transition: all var(--transition);
    }

    .lang-option:hover {
      background: rgba(99, 102, 241, 0.15);
      color: var(--text-primary);
    }

    .lang-option.active {
      background: var(--accent-primary);
      color: #fff;
    }

    .footer-controls a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2.5rem;
      height: 2.5rem;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-full);
      color: var(--text-secondary);
      text-decoration: none;
      transition: all var(--transition);
    }

    .footer-controls a:hover {
      background: rgba(99, 102, 241, 0.15);
      border-color: var(--accent-primary);
      color: var(--accent-primary);
    }

    .footer-copy {
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%) translateY(100%);
      background: rgba(10, 10, 15, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      color: var(--text-primary);
      padding: 0.85rem 1.75rem;
      border-radius: var(--radius-full);
      font-size: 0.95rem;
      font-weight: 500;
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }

    .toast i {
      font-size: 1rem;
    }

    .toast.toast-success i {
      color: var(--success);
    }

    .toast.toast-info i {
      color: var(--accent-primary);
    }

    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .hero {
        padding: 60px 20px 30px;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .hero p {
        font-size: 1rem;
      }

      .generator-card {
        padding: 1.5rem;
      }

      .toggle-group {
        grid-template-columns: 1fr;
      }

      .stats {
        flex-direction: column;
        gap: 0.75rem;
      }

      .info-grid {
        grid-template-columns: 1fr;
      }

      .orb-1,
      .orb-2,
      .orb-3 {
        opacity: 0.4;
      }
    }

    @media (max-width: 480px) {
      .generator-section {
        padding: 0 16px 40px;
      }

      .brand-text {
        display: none;
      }

      #password {
        font-size: 1rem;
      }
    }
  </style>
</head>

<body>
  <!-- Animated Orbs -->
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>


  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-container">
      <div class="hero-badge">
        <span class="hero-badge-dot"></span>
        <span id="status-text">Secure & Private</span>
      </div>
      <h1 id="title">Password Generator</h1>
      <p id="subtitle">Generate strong, unique passwords instantly. Your passwords are created locally and never stored.
      </p>
    </div>
  </section>

  <!-- Generator Section -->
  <section class="generator-section">
    <div class="generator-card">
      <div class="password-group">
        <input id="password" type="text" aria-label="Generated password" placeholder="Please select at least one option"
          readonly />
        <span id="password-placeholder-fallback">Please select at least one option</span>
        <div class="password-actions">
          <button id="copy-btn" type="button" class="btn-icon" aria-label="Copy password" disabled>
            <i class="fas fa-clipboard" aria-hidden="true"></i>
          </button>
          <button id="regenerate-btn" type="button" class="btn-icon" aria-label="Regenerate password">
            <i class="fas fa-sync-alt" aria-hidden="true"></i>
          </button>
        </div>
      </div>

      <div class="toggle-group">
        <button type="button" class="toggle-btn" id="lowercase" aria-pressed="true">
          <span class="toggle-icon">a-z</span>
          <span>Lowercase</span>
        </button>
        <button type="button" class="toggle-btn" id="uppercase" aria-pressed="true">
          <span class="toggle-icon">A-Z</span>
          <span>Uppercase</span>
        </button>
        <button type="button" class="toggle-btn" id="numbers" aria-pressed="true">
          <span class="toggle-icon">0-9</span>
          <span>Numbers</span>
        </button>
        <button type="button" class="toggle-btn" id="symbols" aria-pressed="true">
          <span class="toggle-icon">!@#</span>
          <span>Symbols</span>
        </button>
      </div>

      <div class="slider-group">
        <label for="length-slider" id="length-label">Length</label>
        <input id="length-slider" type="range" min="8" max="128" value="16" />
        <input id="length-number" type="number" min="8" max="128" value="16" />
      </div>

      <div class="strength-group">
        <div id="strength-meter">
          <div id="strength-bar"></div>
        </div>
        <span id="strength-label">Strength</span>
      </div>

      <div class="security-info">
        <div class="security-card">
          <span class="security-card-label">Entropy</span>
          <span id="entropy-value" class="security-card-value entropy">0 bits</span>
        </div>
        <div class="security-card">
          <span class="security-card-label">Time to crack</span>
          <span id="crack-time" class="security-card-value crack-time">—</span>
        </div>
      </div>

      <div class="stats">
        <span class="stat-item">
          <i class="fas fa-shield-alt" aria-hidden="true"></i>
          <span id="passwords-generated-label">Passwords created:</span>
          <span id="counter" class="stat-value">0</span>
        </span>
        <span class="stat-hint">
          <span id="space-hint">Press <kbd>Space</kbd> to regenerate</span>
        </span>
      </div>
    </div>
  </section>

  <!-- Info Section -->
  <section class="info-section">
    <div class="info-panel">
      <h2 id="info-title">What makes a strong password?</h2>
      <div class="info-grid">
        <div class="info-card">
          <i class="fas fa-ruler-horizontal"></i>
          <h3 id="info-long-title">Long</h3>
          <p id="info-long-desc">Use at least 12 characters. Longer passwords are exponentially harder to crack.</p>
        </div>
        <div class="info-card">
          <i class="fas fa-layer-group"></i>
          <h3 id="info-complex-title">Complex</h3>
          <p id="info-complex-desc">Mix uppercase and lowercase letters, numbers, and symbols for maximum security.</p>
        </div>
        <div class="info-card">
          <i class="fas fa-fingerprint"></i>
          <h3 id="info-unique-title">Unique</h3>
          <p id="info-unique-desc">Never reuse passwords across different accounts. Each account needs its own strong
            password.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-controls">
        <div class="lang-selector">
          <button id="lang-trigger" class="lang-trigger" aria-label="Select language">
            <i class="fas fa-globe"></i>
            <span id="current-lang">English</span>
            <i class="fas fa-chevron-up"></i>
          </button>
          <div id="lang-dropdown" class="lang-dropdown" hidden>
            <button class="lang-option" data-lang="en">English</button>
            <button class="lang-option" data-lang="es">Español</button>
            <button class="lang-option" data-lang="fr">Français</button>
            <button class="lang-option" data-lang="tr">Türkçe</button>
          </div>
        </div>
        <a href="https://github.com" target="_blank" rel="noopener noreferrer" aria-label="GitHub repository">
          <i class="fab fa-github" aria-hidden="true"></i>
        </a>
      </div>
      <p class="footer-copy">© 2026 äkv</p>
    </div>
  </footer>

  <div class="toast" id="toast">Copied!</div>

  <script>
    // --- i18n translations ---
    const translations = {
      en: {
        title: "Password Generator",
        subtitle: "Generate strong, unique passwords instantly. Your passwords are created locally and never stored.",
        statusText: "Secure & Private",
        length: "Length",
        includeLower: "Lowercase",
        includeUpper: "Uppercase",
        includeNumbers: "Numbers",
        includeSymbols: "Symbols",
        strength: "Strength",
        weak: "Weak",
        medium: "Medium",
        strong: "Strong",
        excellent: "Excellent",
        copyAria: "Copy password",
        regenerateAria: "Regenerate password",
        password: "Generated password",
        language: "English",
        passwordsCreated: "Passwords created:",
        spaceHint: "Press <kbd>Space</kbd> to regenerate",
        infoTitle: "What makes a strong password?",
        long: "Long",
        longDesc: "Use at least 12 characters. Longer passwords are exponentially harder to crack.",
        complex: "Complex",
        complexDesc: "Mix uppercase and lowercase letters, numbers, and symbols for maximum security.",
        unique: "Unique",
        uniqueDesc: "Never reuse passwords across different accounts. Each account needs its own strong password.",
        copied: "Password copied!",
        generated: "New password generated!"
      },
      es: {
        title: "Generador de Contraseñas",
        subtitle: "Genera contraseñas fuertes y únicas al instante. Tus contraseñas se crean localmente.",
        statusText: "Seguro y Privado",
        length: "Longitud",
        includeLower: "Minúsculas",
        includeUpper: "Mayúsculas",
        includeNumbers: "Números",
        includeSymbols: "Símbolos",
        strength: "Fortaleza",
        weak: "Débil",
        medium: "Media",
        strong: "Fuerte",
        excellent: "Excelente",
        copyAria: "Copiar contraseña",
        regenerateAria: "Regenerar contraseña",
        password: "Contraseña generada",
        language: "Español",
        passwordsCreated: "Contraseñas creadas:",
        spaceHint: "Pulsa <kbd>Espacio</kbd> para regenerar",
        infoTitle: "¿Qué hace una contraseña fuerte?",
        long: "Larga",
        longDesc: "Usa al menos 12 caracteres. Las contraseñas más largas son más difíciles de descifrar.",
        complex: "Compleja",
        complexDesc: "Combina mayúsculas, minúsculas, números y símbolos para máxima seguridad.",
        unique: "Única",
        uniqueDesc: "Nunca reutilices contraseñas. Cada cuenta necesita su propia contraseña fuerte.",
        copied: "¡Contraseña copiada!",
        generated: "¡Nueva contraseña generada!"
      },
      fr: {
        title: "Générateur de Mot de Passe",
        subtitle: "Générez des mots de passe forts et uniques instantanément. Créés localement.",
        statusText: "Sécurisé et Privé",
        length: "Longueur",
        includeLower: "Minuscules",
        includeUpper: "Majuscules",
        includeNumbers: "Chiffres",
        includeSymbols: "Symboles",
        strength: "Robustesse",
        weak: "Faible",
        medium: "Moyenne",
        strong: "Forte",
        excellent: "Excellente",
        copyAria: "Copier le mot de passe",
        regenerateAria: "Régénérer le mot de passe",
        password: "Mot de passe généré",
        language: "Français",
        passwordsCreated: "Mots de passe créés:",
        spaceHint: "Appuyez sur <kbd>Espace</kbd> pour régénérer",
        infoTitle: "Qu'est-ce qu'un mot de passe fort?",
        long: "Long",
        longDesc: "Utilisez au moins 12 caractères. Plus c'est long, plus c'est difficile à craquer.",
        complex: "Complexe",
        complexDesc: "Mélangez majuscules, minuscules, chiffres et symboles pour une sécurité maximale.",
        unique: "Unique",
        uniqueDesc: "Ne réutilisez jamais les mots de passe. Chaque compte a besoin de son propre mot de passe.",
        copied: "Mot de passe copié!",
        generated: "Nouveau mot de passe généré!"
      },
      tr: {
        title: "Şifre Oluşturucu",
        subtitle: "Güçlü ve benzersiz şifreler anında oluşturun. Şifreleriniz yerel olarak oluşturulur.",
        statusText: "Güvenli ve Gizli",
        length: "Uzunluk",
        includeLower: "Küçük Harf",
        includeUpper: "Büyük Harf",
        includeNumbers: "Rakamlar",
        includeSymbols: "Semboller",
        strength: "Güç",
        weak: "Zayıf",
        medium: "Orta",
        strong: "Güçlü",
        excellent: "Mükemmel",
        copyAria: "Şifreyi kopyala",
        regenerateAria: "Şifreyi yeniden oluştur",
        password: "Oluşturulan şifre",
        language: "Türkçe",
        passwordsCreated: "Oluşturulan şifreler:",
        spaceHint: "Yeniden oluşturmak için <kbd>Boşluk</kbd>'a basın",
        infoTitle: "Güçlü bir şifre ne yapar?",
        long: "Uzun",
        longDesc: "En az 12 karakter kullanın. Uzun şifreler kırılması çok daha zordur.",
        complex: "Karmaşık",
        complexDesc: "Büyük-küçük harf, rakam ve sembolleri karıştırarak maksimum güvenlik sağlayın.",
        unique: "Benzersiz",
        uniqueDesc: "Şifreleri asla yeniden kullanmayın. Her hesabın kendi güçlü şifresine ihtiyacı vardır.",
        copied: "Şifre kopyalandı!",
        generated: "Yeni şifre oluşturuldu!"
      }
    };

    // --- Cached DOM elements ---
    const elements = {
      password: document.getElementById("password"),
      copyBtn: document.getElementById("copy-btn"),
      regenerateBtn: document.getElementById("regenerate-btn"),
      lengthSlider: document.getElementById("length-slider"),
      lengthNumber: document.getElementById("length-number"),
      lowercase: document.getElementById("lowercase"),
      uppercase: document.getElementById("uppercase"),
      numbers: document.getElementById("numbers"),
      symbols: document.getElementById("symbols"),
      strengthBar: document.getElementById("strength-bar"),
      strengthLabel: document.getElementById("strength-label"),
      counter: document.getElementById("counter"),
      langTrigger: document.getElementById("lang-trigger"),
      langDropdown: document.getElementById("lang-dropdown"),
      currentLang: document.getElementById("current-lang"),
      title: document.getElementById("title"),
      subtitle: document.getElementById("subtitle"),
      statusText: document.getElementById("status-text"),
      lengthLabel: document.getElementById("length-label"),
      placeholderFallback: document.getElementById("password-placeholder-fallback"),
      passwordGroup: document.querySelector('.password-group'),
      toast: document.getElementById("toast")
    };

    // --- State ---
    let passwordCount = 0;
    let lastGenerated = null;
    let currentLang = localStorage.getItem('pwdgen-lang') || 'en';

    // --- Character sets ---
    const CHARS = {
      lower: "abcdefghijklmnopqrstuvwxyz",
      upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
      number: "0123456789",
      symbol: "!@#$%^&*()-_=+~`|:;,.<>?"
    };

    // --- Utility functions ---
    function nowTimeString() {
      return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
    }

    function getCharset(opts) {
      let chars = "";
      if (opts.lower) chars += CHARS.lower;
      if (opts.upper) chars += CHARS.upper;
      if (opts.number) chars += CHARS.number;
      if (opts.symbol) chars += CHARS.symbol;
      return chars;
    }

    // Securely get a random integer from 0 to max (exclusive)
    function getSecureRandomInt(max) {
      const array = new Uint32Array(1);
      window.crypto.getRandomValues(array);
      return array[0] % max; // Bias is negligible for max << 2^32
    }

    function generatePassword(length, opts) {
      const charset = getCharset(opts);
      if (!charset) return "";

      const result = [];
      const requiredSets = [];
      if (opts.lower) requiredSets.push(CHARS.lower);
      if (opts.upper) requiredSets.push(CHARS.upper);
      if (opts.number) requiredSets.push(CHARS.number);
      if (opts.symbol) requiredSets.push(CHARS.symbol);

      // 1. Guarantee at least one char from each selected set
      for (const set of requiredSets) {
        result.push(set[getSecureRandomInt(set.length)]);
      }

      // 2. Fill the rest of the length
      const remainingLength = length - result.length;
      for (let i = 0; i < remainingLength; i++) {
        result.push(charset[getSecureRandomInt(charset.length)]);
      }

      // 3. Fisher-Yates Shuffle (Cryptographically Secure)
      for (let i = result.length - 1; i > 0; i--) {
        const j = getSecureRandomInt(i + 1);
        [result[i], result[j]] = [result[j], result[i]];
      }

      return result.join("");
    }

    function getOptions() {
      return {
        lower: elements.lowercase.getAttribute('aria-pressed') === 'true',
        upper: elements.uppercase.getAttribute('aria-pressed') === 'true',
        number: elements.numbers.getAttribute('aria-pressed') === 'true',
        symbol: elements.symbols.getAttribute('aria-pressed') === 'true'
      };
    }

    function hasAnyOption(opts) {
      return opts.lower || opts.upper || opts.number || opts.symbol;
    }

    function calculateEntropy(pw, opts) {
      const charset = getCharset(opts);
      if (!pw || !charset) return 0;
      return Math.log2(charset.length) * pw.length;
    }

    function formatCrackTime(entropy) {
      // Assume 10 billion guesses per second (modern GPU cluster)
      const guessesPerSecond = 10e9;
      const totalCombinations = Math.pow(2, entropy);
      const seconds = totalCombinations / guessesPerSecond / 2; // Average is half

      if (seconds < 1) return 'Less than a second';
      if (seconds < 10) return 'A few seconds';
      if (seconds < 60) return 'Under a minute';
      if (seconds < 300) return 'A few minutes';
      if (seconds < 3600) return 'Under an hour';
      if (seconds < 86400) return 'Several hours';
      if (seconds < 604800) return 'A few days';
      if (seconds < 2592000) return 'A few weeks';
      if (seconds < 31536000) return 'Several months';
      if (seconds < 31536000 * 10) return 'A few years';
      if (seconds < 31536000 * 100) return 'Decades';
      if (seconds < 31536000 * 1000) return 'Centuries';
      if (seconds < 31536000 * 1e6) return 'Millennia';
      if (seconds < 31536000 * 1e9) return 'Millions of years';
      return 'Eternity';
    }

    function estimateStrength(pw, opts) {
      const t = translations[currentLang];
      const charset = getCharset(opts);
      if (!pw || !charset) return { score: 0, label: t.weak, color: "var(--danger)", glow: "glow-danger" };

      const entropy = Math.log2(charset.length) * pw.length;
      if (entropy < 40) return { score: 1, label: t.weak, color: "var(--danger)", glow: "glow-danger" };
      if (entropy < 60) return { score: 2, label: t.medium, color: "var(--warning)", glow: "glow-warning" };
      if (entropy < 80) return { score: 3, label: t.strong, color: "var(--success)", glow: "glow-success" };
      return { score: 4, label: t.excellent, color: "var(--excellent)", glow: "glow-excellent" };
    }

    function updateStrengthMeter(pw, opts) {
      const { score, label, color, glow } = estimateStrength(pw, opts);
      const widths = [0, 30, 55, 80, 100];

      // Update strength bar
      elements.strengthBar.style.width = widths[score] + "%";
      elements.strengthBar.style.background = color;
      elements.strengthBar.className = glow;
      elements.strengthLabel.textContent = label;
      elements.strengthLabel.style.color = color;

      // Update entropy display
      const entropy = calculateEntropy(pw, opts);
      document.getElementById('entropy-value').textContent = `${Math.round(entropy)} bits`;

      // Update crack time display
      const crackTime = formatCrackTime(entropy);
      const crackTimeEl = document.getElementById('crack-time');
      crackTimeEl.textContent = crackTime;

      // Color code the crack time
      if (entropy < 40) {
        crackTimeEl.style.color = 'var(--danger)';
      } else if (entropy < 60) {
        crackTimeEl.style.color = 'var(--warning)';
      } else {
        crackTimeEl.style.color = 'var(--success)';
      }
    }


    function showToast(message, icon = '', type = 'info') {
      if (elements.toast.timeout) clearTimeout(elements.toast.timeout);
      elements.toast.classList.remove('show', 'toast-success', 'toast-info');
      void elements.toast.offsetWidth;

      const iconHtml = icon ? `<i class="${icon}" aria-hidden="true"></i>` : '';
      elements.toast.innerHTML = iconHtml + `<span>${message}</span>`;
      elements.toast.classList.add('show', `toast-${type}`);

      elements.toast.timeout = setTimeout(() => {
        elements.toast.classList.remove('show');
      }, 2000);
    }

    function updateCopyButton() {
      const hasPassword = elements.password.value && elements.password.value.length > 0;
      elements.copyBtn.disabled = !hasPassword;
    }

    function syncLengthInputs(val) {
      elements.lengthSlider.value = val;
      elements.lengthNumber.value = val;
      updateSliderFill();
    }

    function updateSliderFill() {
      const slider = elements.lengthSlider;
      const min = parseInt(slider.min);
      const max = parseInt(slider.max);
      const val = parseInt(slider.value);
      const percent = ((val - min) / (max - min)) * 100;
      slider.style.background = `linear-gradient(to right, var(--accent-primary) 0%, var(--accent-tertiary) ${percent}%, rgba(255, 255, 255, 0.1) ${percent}%)`;
    }

    // --- Stats ---
    async function fetchStats() {
      try {
        const response = await fetch('/api/stats');
        if (!response.ok) throw new Error('Failed to fetch stats');
        const data = await response.json();
        if (data && typeof data.count === 'number') {
          passwordCount = data.count;
          lastGenerated = data.lastGenerated;
          updateStatsDisplay();
        }
      } catch (error) {
        // Fallback to localStorage
        const savedCount = localStorage.getItem('pwdgen-count');
        if (savedCount) {
          passwordCount = parseInt(savedCount, 10);
          lastGenerated = localStorage.getItem('pwdgen-last');
          updateStatsDisplay();
        }
      }
    }

    function updateStatsDisplay() {
      elements.counter.textContent = passwordCount;
    }

    async function updateStats() {
      updateStatsDisplay();
      localStorage.setItem('pwdgen-count', passwordCount.toString());
      localStorage.setItem('pwdgen-last', lastGenerated);

      try {
        await fetch('/api/stats', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ count: passwordCount, lastGenerated: lastGenerated })
        });
      } catch (error) {
        // Silent fail, local storage is backup
      }
    }

    // --- Preferences ---
    function savePreferences() {
      const preferences = {
        length: parseInt(elements.lengthSlider.value, 10),
        options: getOptions()
      };
      localStorage.setItem('pwdgen-preferences', JSON.stringify(preferences));
    }

    function loadPreferences() {
      try {
        const saved = localStorage.getItem('pwdgen-preferences');
        if (saved) {
          const prefs = JSON.parse(saved);
          syncLengthInputs(prefs.length);
          elements.lowercase.setAttribute('aria-pressed', prefs.options.lower);
          elements.uppercase.setAttribute('aria-pressed', prefs.options.upper);
          elements.numbers.setAttribute('aria-pressed', prefs.options.number);
          elements.symbols.setAttribute('aria-pressed', prefs.options.symbol);
          return true;
        }
      } catch (e) {
        console.warn('Failed to load preferences');
      }
      return false;
    }

    // --- Generation ---
    function showNoOptionsState() {
      elements.password.value = '';
      elements.passwordGroup.classList.add('fallback-active');
      elements.strengthBar.style.width = '0%';
      elements.strengthLabel.textContent = translations[currentLang].weak;
      elements.strengthLabel.style.color = 'var(--text-muted)';
      updateCopyButton();
    }

    function doGenerate() {
      const length = parseInt(elements.lengthSlider.value, 10);
      const opts = getOptions();

      if (!hasAnyOption(opts)) {
        showNoOptionsState();
        return;
      }

      elements.password.value = generatePassword(length, opts);
      elements.passwordGroup.classList.remove('fallback-active');
      updateStrengthMeter(elements.password.value, opts);
      passwordCount++;
      lastGenerated = nowTimeString();
      updateStats();
      updateCopyButton();
    }

    // --- i18n ---
    function updateI18n() {
      const t = translations[currentLang];

      elements.title.textContent = t.title;
      elements.subtitle.textContent = t.subtitle;
      elements.statusText.textContent = t.statusText;
      elements.lengthLabel.textContent = t.length;
      elements.currentLang.textContent = t.language;
      elements.copyBtn.setAttribute("aria-label", t.copyAria);
      elements.regenerateBtn.setAttribute("aria-label", t.regenerateAria);

      // Stats section
      document.getElementById('passwords-generated-label').textContent = t.passwordsCreated;
      document.getElementById('space-hint').innerHTML = t.spaceHint;

      // Toggle buttons - get the last span (the label, not the icon)
      elements.lowercase.querySelectorAll('span')[1].textContent = t.includeLower;
      elements.uppercase.querySelectorAll('span')[1].textContent = t.includeUpper;
      elements.numbers.querySelectorAll('span')[1].textContent = t.includeNumbers;
      elements.symbols.querySelectorAll('span')[1].textContent = t.includeSymbols;

      // Info panel
      document.getElementById('info-title').textContent = t.infoTitle;
      document.getElementById('info-long-title').textContent = t.long;
      document.getElementById('info-long-desc').textContent = t.longDesc;
      document.getElementById('info-complex-title').textContent = t.complex;
      document.getElementById('info-complex-desc').textContent = t.complexDesc;
      document.getElementById('info-unique-title').textContent = t.unique;
      document.getElementById('info-unique-desc').textContent = t.uniqueDesc;

      // Update strength if password exists
      if (elements.password.value) {
        updateStrengthMeter(elements.password.value, getOptions());
      }

      // Update language dropdown active state
      document.querySelectorAll('.lang-option').forEach(opt => {
        opt.classList.toggle('active', opt.dataset.lang === currentLang);
      });
    }

    function handleCopy() {
      if (!elements.password.value || elements.copyBtn.disabled) return;

      navigator.clipboard.writeText(elements.password.value).then(() => {
        elements.copyBtn.classList.add('success');
        elements.copyBtn.innerHTML = '<i class="fas fa-check" aria-hidden="true"></i>';
        showToast(translations[currentLang].copied, 'fas fa-check-circle', 'success');

        setTimeout(() => {
          elements.copyBtn.classList.remove('success');
          elements.copyBtn.innerHTML = '<i class="fas fa-clipboard" aria-hidden="true"></i>';
        }, 1500);
      }).catch(() => {
        elements.password.select();
        document.execCommand('copy');
        showToast(translations[currentLang].copied, 'fas fa-check-circle', 'success');
      });
    }

    function handleRegenerate() {
      const opts = getOptions();
      if (!hasAnyOption(opts)) return; // Don't do anything if no options selected

      // Add spin animation
      elements.regenerateBtn.classList.add('spinning');
      setTimeout(() => elements.regenerateBtn.classList.remove('spinning'), 500);

      doGenerate();
      showToast(translations[currentLang].generated, 'fas fa-sync-alt', 'info');
    }

    // --- Initialization ---
    async function init() {
      await fetchStats();

      if (!loadPreferences()) {
        syncLengthInputs(16);
      } else {
        updateSliderFill();
      }

      // Toggle button handlers
      [elements.lowercase, elements.uppercase, elements.numbers, elements.symbols].forEach(btn => {
        btn.addEventListener('click', () => {
          const newState = btn.getAttribute('aria-pressed') !== 'true';
          btn.setAttribute('aria-pressed', newState);
          doGenerate();
          savePreferences();
        });
      });

      // Length handlers
      elements.lengthSlider.addEventListener('input', e => {
        syncLengthInputs(e.target.value);
        doGenerate();
        savePreferences();
      });

      elements.lengthNumber.addEventListener('input', e => {
        let val = parseInt(e.target.value, 10);
        if (val < 8) val = 8;
        if (val > 128) val = 128;
        syncLengthInputs(val);
        doGenerate();
        savePreferences();
      });

      // Button handlers
      elements.copyBtn.addEventListener('click', handleCopy);
      elements.regenerateBtn.addEventListener('click', handleRegenerate);

      // Language selector
      elements.langTrigger.addEventListener('click', e => {
        e.stopPropagation();
        elements.langDropdown.hidden = !elements.langDropdown.hidden;
      });

      document.querySelectorAll('.lang-option').forEach(option => {
        option.addEventListener('click', () => {
          currentLang = option.dataset.lang;
          localStorage.setItem('pwdgen-lang', currentLang);
          elements.langDropdown.hidden = true;
          updateI18n();
        });
      });

      document.addEventListener('click', e => {
        if (!elements.langTrigger.contains(e.target) && !elements.langDropdown.contains(e.target)) {
          elements.langDropdown.hidden = true;
        }
      });

      // Keyboard shortcuts
      document.addEventListener('keydown', e => {
        const isInputFocused = document.activeElement.tagName === 'INPUT';
        if (e.code === 'Space' && !isInputFocused) {
          e.preventDefault();
          handleRegenerate();
        }
      });

      updateI18n();
      doGenerate();
    }

    // Start the app
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>

</html>
